"use strict";(self.modernJsonp=self.modernJsonp||[]).push([[4639,51798],{204112:(e,a,n)=>{n.r(a),n.d(a,{default:()=>l});let t={fragment:{argumentDefinitions:i=[{defaultValue:null,kind:"LocalArgument",name:"inviteType"},{defaultValue:null,kind:"LocalArgument",name:"objectId"}],kind:"Fragment",metadata:null,name:"ShareInviteCreateExternalInviteGraphQLQuery",selections:r=[{alias:null,args:[{kind:"Variable",name:"inviteType",variableName:"inviteType"},{kind:"Variable",name:"objectId",variableName:"objectId"}],concreteType:null,kind:"LinkedField",name:"v3InviteUserExternalQuery",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"InviteUserExternal",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"inviteCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"inviteUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null}],storageKey:null}],type:"V3InviteUserExternal",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:i,kind:"Operation",name:"ShareInviteCreateExternalInviteGraphQLQuery",selections:r},params:{id:"9444c7d899b56b0d3f582ffd76e4aa03c97bb76a403a805aeb20150c64ee61d7",metadata:{},name:"ShareInviteCreateExternalInviteGraphQLQuery",operationKind:"query",text:null}};t.hash="cbe2c69120b8bcf572c2bd64e6b7b3fd";let l=t;var i,r,o=t.default||t;if("query"===o.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(o);else{let e=[o.params.name,o.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=o}},669457:(e,a,n)=>{n.r(a),n.d(a,{default:()=>l});let t={fragment:{argumentDefinitions:i=[{defaultValue:null,kind:"LocalArgument",name:"invite_category"},{defaultValue:null,kind:"LocalArgument",name:"url"}],kind:"Fragment",metadata:null,name:"ShareInviteCreateShareLinkGraphQLQuery",selections:r=[{alias:null,args:[{kind:"Variable",name:"inviteCategory",variableName:"invite_category"},{kind:"Literal",name:"name",value:""},{kind:"Variable",name:"url",variableName:"url"}],concreteType:null,kind:"LinkedField",name:"v3CreateShareLinkQuery",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ShareLink",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"inviteCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"inviteUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null}],storageKey:null}],type:"V3CreateShareLink",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:i,kind:"Operation",name:"ShareInviteCreateShareLinkGraphQLQuery",selections:r},params:{id:"1a2c34659f0fc64fb8a13ad996b008dbd6b92e50c9b051a13ea424a4eeda7cb4",metadata:{},name:"ShareInviteCreateShareLinkGraphQLQuery",operationKind:"query",text:null}};t.hash="7e0a6acc000f5df88d88c8ea103f3da3";let l=t;var i,r,o=t.default||t;if("query"===o.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(o);else{let e=[o.params.name,o.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=o}},479335:(e,a,n)=>{var t,l;n.r(a),n.d(a,{default:()=>r});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useDownloadImageUnauth_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupDescription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[t,l],storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{args:null,kind:"FragmentSpread",name:"usePinGifOrImageSrc_pin"},{args:null,kind:"FragmentSpread",name:"usePinImageUrls_pin"}],type:"Pin",abstractKey:null};i.hash="c6672a53b22adb94fdbd03277be340a8";let r=i},852450:(e,a,n)=>{n.r(a),n.d(a,{default:()=>l});let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"usePinGifOrImageSrc_pin",selections:[{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};t.hash="e4de3c30775bc66fe057a2692ac884eb";let l=t},615027:(e,a,n)=>{var t;n.r(a),n.d(a,{default:()=>i});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"usePinImageUrls_pin",selections:[{alias:"imageSpec_60x60",args:[{kind:"Literal",name:"spec",value:"60x60"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t=[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"60x60")'},{alias:"imageSpec_136x136",args:[{kind:"Literal",name:"spec",value:"136x136"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"136x136")'},{alias:"imageSpec_170x",args:[{kind:"Literal",name:"spec",value:"170x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"170x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"236x")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"474x")'},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"736x")'},{alias:"imageSpec_600x315",args:[{kind:"Literal",name:"spec",value:"600x315"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"600x315")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:t,storageKey:'images(spec:"orig")'}],type:"Pin",abstractKey:null};l.hash="b7ea441f2c20a68b323088ebe3847835";let i=l},395986:(e,a,n)=>{n.d(a,{Z:()=>v});var t,l,i=n(167912),r=n(578373),o=n(518761),s=n(397657),d=n(833858),c=n(600009),u=n(183908),_=n(32526);let p={open(e){let a=p._validParams.reduce((a,n)=>(e&&Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]),a),{}),n=p._getDialogType(e),t=p.generateFbRef(e.unauthId??""),l=e.object_type&&e.object_id&&"feed"===n,i=(0,c.Z)(e.path),r=(0,_.Z)();if(r.ptrf&&(i=(0,u.Z)(i,{ptrf:r.ptrf})),l&&(i=(0,u.Z)(i,{fb_ref:t})),a.method=n,"feed"===a.method){let n=(0,o.Z)({width:e.width,height:e.height}),t="http://www.facebook.com/sharer/sharer.php?u="+i;a.picture&&(t+="&picture="+a.picture),a.name&&(t+="&title="+a.name),a.description&&(t+="&description="+a.description),a.caption&&(t+="&caption="+a.caption),window.open(encodeURI(t),"sharer",n)}else"send"===a.method?a.link=i:"share"===a.method&&(a.href=i),(0,d.default)(n=>{n?.getLoginStatus(()=>{if("send"===a.method){let t;n.ui(a);let l=10,i=setInterval(()=>{((t=function(){if(!document)return;let e=Array.from(document.querySelectorAll(".fb_dialog_iframe iframe")).filter(e=>e instanceof HTMLIFrameElement);if(e.length)return e.slice(0,e.length-1).forEach(e=>e.parentNode?.removeChild(e)),e[e.length-1]}())||!l)&&(clearInterval(i),t&&p.executeMessengerCallback(t,e.callback)),l-=1},1e3)}else"share"===a.method&&n.ui(a,a=>{l&&a&&!a.error_message&&(0,s.Z)({url:`/v3/log/facebook/feed_share/${e.object_type||""}/${e.object_id||""}/${t}`,method:"PUT",data:{showError:!1}}),e.callback&&e.callback(a)})})},e.viewer)},_validParams:["description","name","picture","to","href","caption","display"],_validOptions:["send","feed","share"],executeMessengerCallback(e,a){let n=10,t=setInterval(()=>{let{width:a}=e.style;"0px"!==a&&n||(clearInterval(t),e.style.width="575px"),n-=1},1e3);a&&a()},generateFbRef(e){let a="";for(;a.length<20;)a+=Math.floor(65535*Math.random()).toString(16);return e+":"+a},_getDialogType:e=>p._validOptions.includes(e.type)?e.type:"feed"},m=function(e,a){let n=window.screen.width,t=window.screen.height,l=Math.round((n-e)/2),i=t>a?Math.round((t-a)/2):0;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+e+",height="+a+",left="+l+",top="+i};function g(e,a,n){let t=m(a,n);window.open(e,void 0,t)}let y={DIALOG_WIDTH:510,DIALOG_HEIGHT:525,openDialog(e){g(y._getWindowUrl(e.share_path,e.share_text),y.DIALOG_WIDTH,y.DIALOG_HEIGHT)},_getWindowUrl:(e,a)=>(0,u.Z)("https://social-plugins.line.me/lineit/share",{url:e?(0,c.Z)(e):void 0,text:a})},h={DIALOG_WIDTH:550,DIALOG_HEIGHT:420,openDialog(e){g(h._getWindowUrl(e.tweet_path,e.tweet_text),h.DIALOG_WIDTH,h.DIALOG_HEIGHT)},_getWindowUrl:(e,a)=>(0,u.Z)("https://twitter.com/intent/tweet",{via:"pinterest",url:e?(0,c.Z)(e):void 0,text:a||void 0})},b=void 0!==t?t:t=n(204112),w=void 0!==l?l:l=n(669457);function v(){let e={pin:1,board:2,pinner:3,article:5,did_it:6,today_article:8,search:0},a=(()=>{let e=(0,i.useRelayEnvironment)();return async(a,n)=>await new Promise((t,l)=>(0,i.fetchQuery)(e,w,{invite_category:n.toString(),url:a}).subscribe({next:e=>t({invite_code:e.v3CreateShareLinkQuery?.data?.inviteCode??"",invite_url:e.v3CreateShareLinkQuery?.data?.inviteUrl??"",title:e.v3CreateShareLinkQuery?.data?.title??""}),error:e=>l(e)}))})(),n=(()=>{let e=(0,i.useRelayEnvironment)();return async(a,n,t,l)=>{let r={invite_category:a,invite_object:n,invite_channel:t};return await new Promise((a,n)=>(0,i.fetchQuery)(e,b,{inviteType:JSON.stringify(r),objectId:l}).subscribe({next:e=>a({invite_code:e.v3InviteUserExternalQuery?.data?.inviteCode??"",invite_url:e.v3InviteUserExternalQuery?.data?.inviteUrl??"",title:e.v3InviteUserExternalQuery?.data?.title??""}),error:e=>n(e)}))}})();function t(a,n){let t=e[a.object_type]||0,l=a.invite_channel,i=null==a.invite_category?3:a.invite_category,o=a.object_id;return r.Z.create("SentExternalInviteCallbackResource",{invite_type:{invite_category:i,invite_object:t,invite_channel:l},invite_code:n,object_id:o,client_tracking_params:a.client_tracking_params}).callCreate()}function l(t){let l=e[t.object_type]||0,i=t.invite_channel,r=null==t.invite_category?3:t.invite_category;return 10===r&&t.path?a(t.path,r):n(r,l,i.toString(),t.object_id)}return{ObjectTypeToInviteObject:e,logShareInvite:function(e,a){a&&t(e,a.invite_code)},createShareInviteData:l,shareFacebookInvite:function(e){let{options:a,unauthId:n,viewer:i}=e;return l(a).then(e=>{let l=e.invite_url,r=e.invite_code;if(l){let o={type:"share",object_type:a.object_type,object_id:a.object_id,name:a.name,caption:e.title,description:a.description,path:l,picture:a.picture,callback(e){e&&!e.error_message&&t(a,r)}};p.open({...o,display:"popup",unauthId:n,viewer:i})}return Promise.resolve(e)},e=>Promise.reject(e))},shareTwitterInvite:function(a){let n=e[a.object_type]||0;return l(a).then(e=>{let l=e.invite_url,i=e.invite_code,r=a.description;return 6===n&&a.name&&(r=a.name),r.trim()||(r=`${e.title}
`),l&&h.openDialog({tweet_path:l,tweet_text:r}),t(a,i),Promise.resolve(e)},e=>Promise.reject(e))},shareLineInvite:function(a){let n=e[a.object_type]||0;return l(a).then(e=>{let l=e.invite_url,i=e.invite_code,r=a.description;return 6===n&&a.name&&(r=a.name),r.trim()||(r=`${e.title}
`),l&&y.openDialog({share_path:l,share_text:r}),t(a,i),Promise.resolve(e)},e=>Promise.reject(e))},shareFbMessengerInvite:function(e){let{options:a,unauthId:n,viewer:i}=e;return l(a).then(e=>{let l=e.invite_url,r=e.invite_code;return l&&p.open({type:"send",object_type:a.object_type,object_id:a.object_id,name:a.name,caption:e.title,description:a.description,path:l,picture:a.picture,callback(e){e&&e.success&&t(a,r)},display:"popup",unauthId:n,viewer:i}),Promise.resolve(e)},e=>Promise.reject(e))}}}},883995:(e,a,n)=>{n.d(a,{Z:()=>o});var t=n(859492),l=n(112800);let i=Object.freeze(new Set(["sensitive_raw_pin_text","is_sensitive_rich_pin_description"])),r=e=>(e||"").trim().replace(/\s+/g," "),o=({storyPinDataId:e,pinDescription:a,richMetadataDescription:n,richSummaryDisplayName:o,closeupDescription:s,closeupUnifiedDescription:d,seoNoindexReason:c,shouldLogUnauthDesc:u,shouldUseSimplifiedDescription:_=!1})=>(u&&(0,l.My)("unauth_closeup.pin_desc",{useSeoFallback:!!c&&i.has(c??""),isStoryPin:!!e,pinDescription:r(a),closeupUnifiedDescription:r(d),closeupDescription:r(s),richMetadataDescription:r(n)}),c&&i.has(c??""))?"":_?(0,t.jM)({closeupUnifiedDescription:d,pinDescription:a}):r((0,t.eK)({richMetadataDescription:n,richSummaryDisplayName:o,closeupUnifiedDescription:d}).description)||r(d||"")||r(s)||r(a)||r(n)||""},414686:(e,a,n)=>{n.d(a,{Z:()=>s}),n(167912);var t,l=n(78039),i=n(139714),r=n(174646);let o=void 0!==t?t:t=n(852450);function s(e,a,n){let t=(0,l.Z)(o,e),{isBot:s,isSocialBot:d}=(0,r.B)();return(0,i.Z)({embedSrc:t?.embed?.src,embedType:t?.embed?.type,imagesUrls:a,preferredResolution:n??"736x",excludeOriginals:!s&&!d})}},622809:(e,a,n)=>{n.d(a,{Z:()=>r}),n(167912);var t,l=n(78039);let i=void 0!==t?t:t=n(615027),r=e=>{let a=(0,l.Z)(i,e);return[["60x60",a?.imageSpec_60x60],["136x136",a?.imageSpec_136x136],["170x",a?.imageSpec_170x],["236x",a?.imageSpec_236x],["474x",a?.imageSpec_474x],["564x",a?.imageSpec_564x],["736x",a?.imageSpec_736x],["600x315",a?.imageSpec_600x315],["orig",a?.imageSpec_orig]].reduce((e,[a,n])=>n?{...e,[a]:n.url}:e,{})}},833858:(e,a,n)=>{n.r(a),n.d(a,{default:()=>u});var t=n(397657),l=n(750065),i=n(591471),r=n(801888),o=n(142212),s=n(112800);let d=!1,c=(e,a,n="en-US",u)=>{u&&(0,s.dy)({event:"load_script_start",provider:"facebook"}),(0,l.Z)((0,r.Z)(n),"FACEBOOK").then(()=>{u&&(0,s.dy)({event:"load_script_success",provider:"facebook"});let n=window.FB;if(!n){u&&(0,s.dy)({event:"global_object_not_found",provider:"facebook"});return}d||(u&&(0,s.dy)({event:"initialize_library",provider:"facebook"}),n.init({appId:o.GHq,status:!0,version:"v2.2"}),FB.Event.subscribe("auth.statusChange",()=>{a.isAuth&&a.facebookId&&!a.isLimitedLogin&&c(e=>{if(!e?.getUserID())return;let a=e.getAccessToken();a&&(0,t.Z)({url:"/v3/connect/facebook/",method:"POST",data:{facebook_token:a}})},a)}),d=!0,window.fb_init=i.Z.FINISHED),e(n)}),window.fb_init=i.Z.STARTED},u=c},861084:(e,a,n)=>{n.d(a,{Z:()=>_});var t=n(667294),l=n(20256),i=n(95460),r=n(231333),o=n(233846),s=n(181710),d=n(339908),c=n(785893);let u=(0,t.lazy)(()=>n.e(4603).then(n.t.bind(n,774855,23)));function _({linkURL:e,onDidFocus:a,onDidClickCopyButton:n,onCopyText:t,toastDuration:_,oneToast:p=!1,hideInput:m=!1,buttonSize:g="lg",asLink:y=!1}){let h=(0,o.ZP)(),{showToast:b,showOneToast:w}=(0,d.F9)(),v=h._('Copy link', '[button] copy a URL link shown, to paste in another place', '[button] copy a URL link shown, to paste in another place'),k=(e,a)=>{a&&(p?w:b)(({hideToast:e})=>(0,c.jsx)(r.Z,{duration:_,onHide:e,text:t??h._('Link copied to clipboard!', 'toast message to confirm if users copied the url successfully', 'toast message to confirm if users copied the url successfully')})),n()};return y?(0,c.jsx)(i.Z,{name:"SafeSuspense_CopyableLink_CopyToClipboard",children:(0,c.jsx)(s.Z,{fallback:(0,c.jsx)(l.zx,{disabled:!0,text:v}),children:(0,c.jsx)(u,{onCopy:k,text:e,children:(0,c.jsx)(l.rU,{display:"inline",href:"",children:v})})})}):(0,c.jsxs)(l.xu,{alignItems:"center",display:"flex",paddingX:4*!m,children:[!m&&(0,c.jsx)(l.xu,{flex:"grow",marginEnd:2,children:(0,c.jsx)(l.nv,{id:"copylinkurl",onChange:()=>{},onFocus:a,size:"lg",type:"url",value:e})}),(0,c.jsx)(i.Z,{name:"SafeSuspense_CopyableLink_CopyToClipboard",children:(0,c.jsx)(s.Z,{fallback:(0,c.jsx)(l.zx,{disabled:!0,text:v}),children:(0,c.jsx)(u,{onCopy:k,text:e,children:(0,c.jsx)(l.zx,{size:g,text:v})})})})]})}},102083:(e,a,n)=>{n.d(a,{Z:()=>u});var t=n(667294),l=n(20256),i=n(19963),r=n(233846),o=n(395986),s=n(755090),d=n(861084),c=n(785893);function u({pinId:e,variant:a,onSendButtonClick:n,dismissPriorToast:u}){let _=(0,r.ZP)(),{logContextEvent:p}=(0,i.v)(),[m,g]=(0,t.useState)(null),[y,h]=(0,t.useState)(!1),{logShareInvite:b,createShareInviteData:w}=(0,o.Z)(),v=()=>{null===m||y||(h(!0),b({invite_category:3,invite_channel:12,object_type:1,object_id:e,path:null},m))},k=()=>{p({event_type:101,component:14162,element:72,object_id_str:e})};return(0,s.Z)(()=>{(async()=>{g(await w({invite_category:3,invite_channel:12,object_type:"pin",object_id:e,path:""}))})()}),"copy_link"===a?(0,c.jsxs)(l.xu,{"data-test-id":"post-download-copy-link",children:[_._('Image downloaded to your device. ', 'context_menu.pin_downloaded.toastText', 'toast message to confirm when users downloaded a pin image'),(0,c.jsx)(d.Z,{asLink:!0,buttonSize:"sm",hideInput:!0,linkURL:m?.invite_url||"",onCopyText:_._('Copied link to your clipboard to share', 'context_menu.pin_downloaded.copy_link_button_activate', 'notify the user that the link is now copied to their clipboard'),onDidClickCopyButton:()=>{v(),k()},onDidFocus:v,oneToast:!0,toastDuration:5e3})]}):(0,c.jsxs)(l.xu,{"data-test-id":"post-download-share-pin",children:[_._('Image downloaded to your device. ', 'context_menu.pin_downloaded.toastText', 'toast message to confirm when users downloaded a pin image'),(0,c.jsx)(l.rU,{accessibilityLabel:_._('Share Pin', 'context_menu.pin_downloaded.share_pin_button', 'toast message that shows share pin sharesheet invite CTA'),display:"inline",href:"",onClick:({event:e})=>{u(),n(e),k()},children:_._('Share Pin', 'context_menu.pin_downloaded.share_pin_button', 'toast message that shows share pin sharesheet invite CTA')})]})}},178901:(e,a,n)=>{n.d(a,{H:()=>o,Z:()=>r});var t=n(547504),l=n(943369),i=n(112800);async function r({filename:e,imgSrc:a,imageDownloadSuccessCallback:n,category:t,pinId:l,viewParameter:r,viewType:o,isUnauth:s=!1,platform:d="web",expName:c,expGroup:u},_){return"undefined"==typeof window?Promise.resolve():((0,i.My)("web.download.click",{category:t||"no_category",authType:s?"unauth":"auth",platform:d,viewType:o,expName:c,expGroup:u}),_({event_type:82,object_id_str:l,view_type:o||3,view_parameter:r||139}),a&&document)?fetch(a,{headers:new Headers({Origin:window.location.origin}),mode:"cors"}).then(e=>e.blob()).then(a=>{let l=document.createElement("a");l.href=window.URL.createObjectURL(a),l.setAttribute("download",e&&e.replace(".","_")),l.style.display="none",document.body?.appendChild(l),l.click(),document.body?.removeChild(l),(0,i.My)("web.download.success",{category:t||"no_category",authType:s?"unauth":"auth",platform:d,viewType:o,expName:c,expGroup:u}),n?.()}).catch(()=>{throw(0,i.My)("web.download.failure",{category:t||"no_category",authType:s?"unauth":"auth",platform:d,viewType:o,expName:c,expGroup:u}),Error("Download image error")}):Promise.resolve()}let o=e=>{let a=(0,l.M0)(),n=e("unuath_download_paywalled").anyEnabled;if(!a.accessAllowed||n)return{limitReached:!0,oldCount:0,newCount:0};let i=a.getItem(t.rN)||0,r=i>=1,o=r?i:i+1;return i!==o&&(0,l.M0)().setItem(t.rN,o),{limitReached:r,oldCount:i,newCount:o}}},4639:(e,a,n)=>{n.d(a,{Z:()=>T,e:()=>E});var t,l=n(667294),i=n(545007);n(167912);var r=n(20256),o=n(19963),s=n(231333),d=n(78039),c=n(233846),u=n(787642),_=n(883995),p=n(859492),m=n(414686),g=n(622809),y=n(967312),h=n(174646),b=n(676620),w=n(112800),v=n(339908),k=n(34632),f=n(538645),x=n(102083),S=n(178901),I=n(507815),L=n(785893);let C=void 0!==t?t:t=n(479335);function E({seoDrawerPinType:e}){let{checkExperiment:a}=(0,y.F)(),{isAuthenticated:n,isBot:t,locale:l}=(0,h.B)(),i=(0,f.ml)(),r=(0,f.HG)(),o=!n&&!t,{userIsEligibleForShippedLOPExperiment:s}=(0,u.Z)(),d=o&&r&&"closeup_feed"===e&&s(),c="en-US"===l||"en-CA"===l,_=o&&!i&&c&&a("unauth_dweb_download_cta").anyEnabled,p=o&&i&&c&&a("unauth_mweb_download_cta").anyEnabled,m=o&&!r&&!p&&s();return{showDownloadIconForRelatedPins:d,inDwebDownloadCTAExp:_,inMwebDownloadCTAExp:p,showDownloadCloseupIcon:m,inDwebSwapDownloadUpsellExp:o&&r&&a("unauth_dweb_swap_download_upsell").anyEnabled,inMwebSwapDownloadUpsellExp:o&&!r&&a("unauth_mweb_swap_download_upsell").anyEnabled}}let T=({pinKey:e,onSendButtonClick:a,seoDrawerPinType:n})=>{let t,u=(0,d.Z)(C,e),h=(0,b.Z)(),{checkExperiment:T}=(0,y.F)(),D=(0,i.I0)();try{t=(0,I.v)().unauthUserStateDispatch}catch{t=void 0}let{logContextEvent:P}=(0,o.v)(),{showOneToast:F}=(0,v.F9)(),j=(0,c.ZP)(),A=(0,f.HG)(),R=u?.entityId??"",{category:U}=u||{},K=(0,g.Z)(u),O=(0,m.Z)(u,K),Z=u?.richSummary?.displayName??"",Q=u?.richMetadata?.title??"",G=u?.richMetadata?.description??"",H=u?.storyPinData?.metadata?.pinTitle,M=u?.pinJoin?.visualAnnotation||void 0,N=(0,p.Ly)({pinTitle:u?.title,gridTitle:u?.gridTitle,richSummaryDisplayName:Z,richMetadataTitle:Q,storyPinDataId:u?.storyPinDataId,storyPinDataMetadataPinTitle:H,pinJoinVisualAnnotation:M}),z=(0,_.Z)({storyPinDataId:u?.storyPinDataId,pinDescription:u?.description,richMetadataDescription:G,richSummaryDisplayName:Z,closeupDescription:u?.closeupDescription,closeupUnifiedDescription:u?.closeupUnifiedDescription}),W=T("dweb_upsell_manager_redux"),{showDownloadIconForRelatedPins:q,inDwebDownloadCTAExp:V,inMwebDownloadCTAExp:$,showDownloadCloseupIcon:B,inDwebSwapDownloadUpsellExp:J,inMwebSwapDownloadUpsellExp:Y}=E({seoDrawerPinType:n}),X=V||$||q||B||J&&("enabled_immediate_upsell"===T("unauth_dweb_swap_download_upsell").group||"enabled_immediate_signup_upsell"===T("unauth_dweb_swap_download_upsell").group)||Y&&("enabled_immediate_upsell"===T("unauth_mweb_swap_download_upsell").group||"enabled_immediate_signup_upsell"===T("unauth_mweb_swap_download_upsell").group),ee="action_bar_ellipsis";q?ee="related_pin_action_bar_download":V?ee="dweb_download_cta":$?ee="mweb_download_cta":B?ee="mweb_download_closeup_icon":J?ee="dweb_swap_download_upsell":Y&&(ee="mweb_swap_download_upsell");let ea="enabled_immediate_signup_upsell"===T("unauth_dweb_swap_download_upsell").group||"enabled_immediate_signup_upsell"===T("unauth_mweb_swap_download_upsell").group;return(0,l.useCallback)(()=>{let{limitReached:e,oldCount:n,newCount:l}=(0,S.H)(T);if(q?(0,w.My)("dweb.unauth.action_bar.download_image",{attributionLabelSource:ee,limitReached:e,oldCount:n,newCount:l}):V?(0,w.My)("dweb.unauth.download_cta.download_image",{attributionLabelSource:ee}):$?(0,w.My)("mweb.unauth.download_cta.download_image",{attributionLabelSource:ee}):B?(0,w.My)("mweb.unauth.download_closeup_icon.download_image",{attributionLabelSource:ee}):J?(0,w.My)("dweb.unauth.swap_download_upsell.download_image",{attributionLabelSource:ee}):Y?(0,w.My)("mweb.unauth.swap_download_upsell.download_image",{attributionLabelSource:ee}):A?(0,w.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:ee,limitReached:e,oldCount:n,newCount:l}):(0,w.My)("mweb.unauth.context_menu.download_image",{attributionLabelSource:ee,limitReached:e,oldCount:n,newCount:l}),e||X)return void($||B?h({reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",attributionLabel:`click_${ee}_download_button`,mobileOptions:{headingType:"download_limit_reached"}}):W.anyEnabled||X&&!ea?D((0,k.QG)(R)):J&&!ea?h({reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",attributionLabel:`click_${ee}_download_button`,desktopOptions:{modalType:"login",modalOptions:{source:"lopDownloadUpsell",container:"lopDownloadUpsell"}}}):Y&&!ea?h({reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",attributionLabel:`click_${ee}_download_button`,mobileOptions:{headingType:"lopDownloadUpsell"}}):h({reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",attributionLabel:`click_${ee}_download_button`,desktopOptions:{modalType:"signup",modalOptions:{source:"downloadImageBtnUnauth",container:"download",savePinId:R}}}));(0,S.Z)({filename:N||z||R,imgSrc:O||"",category:U,pinId:R,isUnauth:!0,platform:"web",imageDownloadSuccessCallback:()=>{t&&t({type:"UPDATE"})}},P),F(({hideToast:e})=>(0,L.jsx)(s.Z,{duration:5e3,onHide:e,text:(0,L.jsx)(r.xv,{color:"inverse",children:(0,L.jsx)(x.Z,{dismissPriorToast:e,onSendButtonClick:a??(()=>{}),pinId:R,variant:"sharesheet"})}),thumbnail:{image:(0,L.jsx)(r.Ee,{alt:j._('Image of downloaded Pin', 'context_menu.pin_downloaded.altImageText', 'Alt text for image shown when downloading pin'),fit:"cover",naturalHeight:32,naturalWidth:32,src:O})}}))},[T,ee,N,z,R,O,U,P,q,V,X,$,B,J,Y,ea,F,W.anyEnabled,D,h,a,j,A,t])}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/4639-2493a757f694f0ba.mjs.map